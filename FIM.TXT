$Id$
------------------------------------------------------------------------------
*fim.txt*	For Fim version 0.1.  Last change: 2007 02 12

			Fim - main help file (UNDER DEVELOPEMENT)

First of all, please view this documentation in VIM with ':set syntax=help' :)
if you already know Vim, you will know that in this way you can use this
documentation as it would be a hypertext.
If you do not know Vim, you can find it at http://www.vim.org.


Thank you for giving a try to this software; one can regard it as a 'hack',in
the sense it is the result of the passionate work of multiple people.

------------------------------------------------------------------------------
0. Introduction 						*intro*

									 k
      Move the image around:
                    Use the cursor keys, or "h" to go left,	       h   l
		    "j" to go down, "k" to go up, "l" to go right.	 j
   Get out of Fim:  Use ":q<Enter>" (careful, all changes are lost!).

Fim stands for Fbi IMproved.

Fbi is a framebuffer-based image viewer, made by Gerd Knorr, and Fim is
mainly an interface rework applied roughly as a patch to it.

The main purposes of Fim is to boost the features present Fbi and adding new
ones. 

This includes principally the configurability of the keyboard bindings.
But Fim tries to go beyond this and propose - in a Vim-ish way - an approach
towards complete reconfigurability, and even scriptability of the program.
The inspiration for this comes from the use of the nicer software available 
as free software, often characterized by extreme flexibility, configurability,
hackability. This concerns mainly text editors, but why can't apply to an 
image viewer, too ?

==============================================================================
1. Index						*index*

Introduction to Fim					*ref* *reference*

0. Introduction			|intro|
1. Index			|index|
2. Fim on the internet		|internet|
3. Basic Usage			|basics|
4. Command Line Mode		|cli|
5. Command Line Mode Basics	|cli-basics|
6. Commands Reference		|commands-reference|
7. Autocommands			|autocommands|
8. Pattern Matching		|pattern-matching|
9. Dangers			|dangers|
10. Language Reference		|langref|
11. Credits			|credits|

==============================================================================
2. Fim on the internet				*internet*

As of now, the official Fim page is https://code.autistici.org/project/fim, 
although it doesn't say much.

You could be able to browse the Fim code on :
	http://code.autistici.org/svn/fim/
and get the latest source code tree issuing  	:

wget -r http://code.autistici.org/svn/fim/ && cd code.autistici.org/svn/fim 

or (not available yet)
 	svn co svn+ssh://dezperado@code.autistici.org/svn/fim

The documentation is distributed with the software.

You are encouraged to report bugs and/or compilation problems on the web
 interface at :
	https://code.autistici.org/trac/fim

To send me a more complete report:
 ( make;make report ) | gzip  > fim.`date +%Y%m%d%H%M`.log.gz

==============================================================================
3. Basic Usage					*basics*

The basic usage of Fim consists of calling it from the shell ,in a non-X
environment (assuming the framebuffer enabled):

 #fim picture.jpg picture.png

Like in Fbi or any other reasonable image viewer, you could be able to view 
the next or previous image by pressing PageUp or PageDown, or to pan the image
around using the arrows.
Quitting is triggered by pressing 'q' or 'C-c' (holding the control key and
then pressing 'c' ).

In this very basic way, you use the portion of Fim that mimics Fbi.

You could benefit of Fim features by familiarizing to its command line mode.

==============================================================================
4. Command Line Mode					*cli*

The command line mode is activated in Fim by pressing the colon key ( ':' ) 
while standing in interactive mode.
A little cursor will appear on the lower left corner of the screen, and 
subsequent keyboard pressure will reveal that sentences can be written into it.

In this mode, you can issue the internal commands of Fim in an interactive 
fashion, consult the (limited) online help provided with the commands, and 
experiment with the commands.

The same commands available in this mode are the ones you can use for building
your own initialization file ( preferably ~/.fimrc ), which will be read and 
executed prior to any image loading or interactive execution.

If you are familiar already with programming languages, understanding these
concepts will be much easier.

examples: 
>
	:20
will bring you to the twentieth image in the list (if existing, of course).
>
	:$
will bring you to the last image in the list

The same mechanism is achieved with the 'goto' command :
>
	:goto "20" ; goto "$" 

But beware, because 
>
	:20goto "1" 
is like jumping on place 20 times, and 
>
	:$goto
does not make sense.

==============================================================================
5. Commands Line Mode Basics				*cli-basics*

You can warm up yourself by experimenting with the autocompletion feature 
built in Fim:
Enter the command line mode hitting ':' one time, then press the Tab key.

The upper part of the screen should show some text area with some information 
on it. Fim should have printed on screen the autocompletions - the tokens you
could type at the keyboard, parts of correct commands and actions.

Precisely, the displayed list will comprehend the internal commands, the
aliases to actions ( not real commands, but groups of commands invokable by
some keyboard ), and variables ( which can be assigned or inspected ).

For singling out the variables, you can also use the 'variables' command.
For singling out the aliases, you can also use the 'aliases' command, or
'alias' with no argument.

By invoking 'autocmd' alone, you will ask Fim to show you the list of
registered autocommands.

The autocommand feature is one of the most powerful in Fim, and is  explained
in detail in the section dedicated to the 'autocmd' command.

==============================================================================
6. Commands Reference				*commands-reference*

The internal Fim commands are lightweight enough to be used as parts of bigger
commands, that we will call actions.
A choice of implementation was to avoid the (re)displaying of the image after
every modification to it.
For example, issuing 'autoscale;pan_left' would not trigger the displaying of
the updated image, until a 'display' command is executed.

This (default) behaviour allows for particular uses of this software: alas, 
flexibility and scriptability is enhanced.

Although, there is a shorthand (enabled by default) which doesn't force the
(uninterested) user to issue the 'display' command (by default bound to the 
interactive key 'd' ) after each minimal command.

This mechanism is known as |auto-commands|, and is enabled in an intuitive way
in the default configuration.

 UNFINISHED

==============================================================================
7. Auto commands				*auto-commands*
>
	:autocmd EVENT PAT ACTION

Auto commands is a feature present in Vim and other powerful command line 
software, as for example Mutt (there the autocommand concept is a little 
different and therefore called 'hook' ).

The auto-command mechanism provides the user with the ability of making the 
program executing certain actions only in certain circumstances.

By 'circumstances' we mean the pair:
  - it is the case that the user issued a certain EVENT
  - the current file name in the image browser respects a certain PATTERN

an EVENT can be one of:

'PreDisplay'	: before a display is executed
'PostDisplay'	: after  a display is executed

'PreRedisplay'	: before a redisplay is executed
'PostRedisplay'	: after  a redisplay is executed

'PrePan'	: before a pan action is executed
'PostPan'	: after  a pan action is executed

'PreScale'	: before a scaling occurs
'PostScale'	: after  a scaling occurs

'PreLoad'	: before a loading occurs
'PostLoad'	: after  a loading occurs

'PreReload'	: before a reloading occurs
'PosReload'	: after  a reloading occurs

'PreNext'	: before a reloading occurs
'PostNext'	: after  a reloading occurs

'PrePrev'	: before a reloading occurs
'PostPrev'	: after  a reloading occurs

'PreExecutionCycle'  : right before the program gets interactive 
'PostExecutionCycle' : right after  the program gets interactive

'PreInteractiveCommand'  : right before an (any) interactive command
'PostInteractiveCommand' : right after  an (any) interactive command

'PreGoto'	: before a goto jump
'PostGoto'	: after  a goto jump

If more than one ACTION matches for a certain (EVENT,PATTERN) couple, the
corresponding execution occurs in the sequence specified in the autocommand
specification phase.

Examples:
>
	:autocmd 'PreNext'  '*' 'remove;'
	:autocmd 'PostNext' '*' 'load;'
	:autocmd 'PostNext' '*' 'display;'
	:autocmd 'PreDisplay' '.*picture.*' 'auto_scale;'

The first will tell Fim to remove the current image off the file list before
displaying the next one, in a sort of 'consume' fashion.

The second will load the image right after the next command.

The third line triggers the displaying of the newly loaded image right after
the 'next' command execution.

The fourth triggers before displaying, and 'auto_scale's the image only if 
the file name contains the substring 'picture'.

In principle, one could program Fim autocommands to do very nasty and errorful
things; consider, for example:
>
	:autocmd 'PostDisplay' '*' 'display;'

This tells Fim to 'display' the current image each time after the image is ..
.. 'display'ed !
This would lead Fim to an endless 'display' loop.
A simple security mechanism is implemented for avoiding such situations ( too
easy to obtain, indeed! ) :

Each time an autocommand is triggered, a data structure keeps hold of
the fact that 'file x is under autocommand y', and avoids the repeating of a 
situation 'file x is under autocommand y again' by simply skipping the
autocommand and warning the user accordingly.

==============================================================================
8. Pattern matching				*pattern-matching*

Pattern matching capabilities are used for matching a filename with some auto
command.

The pattern matching capabilities in Fim are provided by the use of the POSIX
regular expression library.

The relevant man page is 'man 7 regex'.

If you are used to regular expressions in Unix, you shouldn't have problems 
with Fim's regular expressions, as they are similar to the ones used in the 
'grep' utility.

==============================================================================
8. Dangers						*dangers*

There are plenty of ways of getting the program into an endless loop!
For instance,
>
	:alias 'loop' 'loop;'
will loop forever by calling itself!

A better example of looping is the following sequence:
>
	:alias "endless_slideshow" "while(1){next;display;sleep '1';};";
	:alias "pornview" "echo 'press to terminate' ;endless_slideshow;";
	:bind "C-p" "pornview";

This will turn FIM into slideshow mode, which can be interrupted by the
continued pressure of some key (some unbound key is better!).

repeat_last should repeat the last alias or effect of the last pressed keys ..
..if a line contains repeat_last, it is not recorded in the last_buffer..
idea : repeat_last N ?!

Warning : repeat_last do NOT work in scripts *

 UNFINISHED

==============================================================================
10.Language reference 						*langref*

The implemented Fim minilanguage gives the user the possibility of storing 
values into variables, then performing simple arithmetics, while loops, and 
executing conditionally with the if and if-else construct.

Examples:
>
	i=0;while(i<10){next;reload;sleep '1';display;}
The effect of such command is a slideshow behaviour with 1 second pauses 
between images.

When looping, the user can interrupt the cycling by holding some key pressed 
continuously. Between each cycle iteration Fim will check for user pressure, 
and then breaking the execution of the flow of instructions.

So, the commands following the loop will be ignored.

 UNFINISHED

==============================================================================
11.Credits 							*credits*

 UNFINISHED

------------------------------------------------------------------------------
